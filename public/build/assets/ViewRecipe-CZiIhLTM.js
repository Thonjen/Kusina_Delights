import{L as C}from"./frontend-CQ0GuMzs.js";import{l as p,S as f,m as L,c as T,w as E,o as r,b as e,aV as B,t as d,f as n,p as g,F as w,d as v,g as x,h as R,v as k,n as m}from"./app-B9TWRML0.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";const I={components:{Layout:C},props:{recipe:Object,viewCount:Number,user:Object},data(){return{rating:0,reviewText:"",userHasReviewed:!1,editingReview:null,editReviewText:"",editRating:0}},mounted(){this.userHasReviewed=this.recipe.reviews.some(s=>{var t;return s.user.id===((t=this.user)==null?void 0:t.id)})},methods:{setRating(s){this.rating=s},async submitReview(){if(!this.user){alert("You must be logged in to submit a review.");return}try{const s=await p.post(`/api/recipes/${this.recipe.RecipeID}/reviews`,{review:this.reviewText,star:this.rating,user_id:this.user.id});this.recipe.reviews.push(s.data),this.reviewText="",this.rating=0,this.userHasReviewed=!0,location.reload()}catch(s){console.error("Error submitting review:",s)}},async deleteReview(s){if(!s){console.error("Review ID is undefined.");return}try{if((await f.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",background:"rgba(255, 255, 255, 1)",confirmButtonColor:"rgba(204, 162, 35, 1)",cancelButtonColor:"rgba(54, 69, 79, 1)",iconColor:"rgba(255, 219, 99, 1)",customClass:{popup:"swal-popup"}})).isConfirmed){const l=await p.delete(`/api/recipes/${this.recipe.RecipeID}/reviews/${s}`);this.recipe.reviews=this.recipe.reviews.filter(y=>y.ReviewsID!==s),location.reload()}}catch(t){console.error("Error deleting review:",t)}},startEditing(s){this.editingReview=s,this.editReviewText=s.Review,this.editRating=s.Star},cancelEdit(){this.editingReview=null,this.editReviewText="",this.editRating=0},async saveEdit(){if(this.editingReview)try{const s=await p.put(`/api/recipes/${this.recipe.RecipeID}/reviews/${this.editingReview.ReviewsID}`,{review:this.editReviewText,star:this.editRating});f.fire({title:"Success!",text:"Review updated successfully",icon:"success",confirmButtonColor:"rgba(204, 162, 35, 1)"});const t=this.recipe.reviews.findIndex(l=>l.ReviewsID===this.editingReview.ReviewsID);t!==-1&&(this.recipe.reviews[t]=s.data),this.cancelEdit(),location.reload()}catch(s){console.error("Error updating review:",s),f.fire({title:"Error!",text:"Failed to update review",icon:"error",confirmButtonColor:"rgba(204, 162, 35, 1)"})}},getEmbedUrl(s){if(!s)return"";let t="";return s.includes("youtube.com/watch?v=")?t=s.split("v=")[1]:s.includes("youtu.be/")&&(t=s.split("youtu.be/")[1]),t.includes("&")&&(t=t.split("&")[0]),`https://www.youtube.com/embed/${t}`}}},S={class:"relative h-[362px]"},z={class:"flex items-center justify-center h-full relative"},j={class:"text-white text-center px-4 text-large font-bold drop-shadow-xl white-shadow"},V={class:"absolute bottom-4 right-4 text-white text-lg bg-black opacity-70 px-4 py-2 rounded-full"},N={class:"mx-auto text-left max-w-4xl my-4 text-small text-black-100 space-y-2"},M={class:"list-disc pl-5"},A={class:"list-decimal pl-5 space-y-2 text-justify"},H={class:"text-justify"},U={key:0,class:"mx-auto text-left max-w-4xl my-8"},P={class:"aspect-w-16 aspect-h-9"},F=["src"],Y={class:"p-6 bg-gray-100 rounded-lg max-w-6xl mx-auto space-y-4 mt-8"},O={key:0,class:"inset-0 bg-gray-900 bg-opacity-70 flex items-center justify-center"},q={key:1},G={key:0,class:"bg-white p-4 text-center text-gray-600 font-semibold"},J={key:1,class:"bg-gray-200 rounded-lg p-4 space-y-4"},K={class:"flex items-center text-gray-700 font-bold"},Q={class:"text-gray-600 mt-1"},W={class:"flex flex-col items-center space-y-2"},X={class:"flex items-center space-x-1"},Z=["d"],$={class:"flex justify-center space-x-2"},ee=["onClick"],te=["onClick"],ie={key:2,class:"bg-gray-200 rounded-lg p-4 space-y-3"},se={class:"flex items-center space-x-1 text-2xl"},le=["onClick"],re=["d"],ne={class:"flex justify-start space-x-2 mt-4"},oe={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},de={class:"bg-white p-6 rounded-lg w-96"},ue={class:"flex items-center space-x-1 text-2xl mb-4"},ae=["onClick"],ce=["d"],ge={class:"flex justify-end space-x-2"};function we(s,t,l,y,o,u){const _=L("Layout");return r(),T(_,null,{default:E(()=>{var b,h;return[e("div",S,[e("div",{class:"absolute inset-0 bg-cover bg-center",style:B({backgroundImage:"url('/storage/"+l.recipe.RecipePhoto+"')",filter:"brightness(0.7)"})},null,4),e("div",z,[e("p",j,d(l.recipe.RecipeTitle),1),e("div",V," Views: "+d(l.viewCount),1)])]),e("div",N,[e("div",null,[t[5]||(t[5]=e("p",{class:"text-small font-bold"},"Ingredients",-1)),e("ul",M,[(r(!0),n(w,null,g(l.recipe.Ingredients.split(`
`),(i,a)=>(r(),n("li",{key:a},d(i.trim()),1))),128))])]),t[14]||(t[14]=e("br",null,null,-1)),e("div",null,[t[6]||(t[6]=e("p",{class:"text-small font-bold"},"How To Prepare",-1)),e("ol",A,[(r(!0),n(w,null,g(l.recipe.Instructions.split(`
`),(i,a)=>(r(),n("li",{key:a},d(i.trim()),1))),128))])]),t[15]||(t[15]=e("br",null,null,-1)),e("div",null,[t[12]||(t[12]=e("p",{class:"font-bold space-y-2"},"Additional Information:",-1)),e("p",null,[t[7]||(t[7]=e("strong",null,"Preparation Time:",-1)),v(" "+d(l.recipe.Preparation||"N/A")+" minutes",1)]),e("p",null,[t[8]||(t[8]=e("strong",null,"Cooking Time:",-1)),v(" "+d(l.recipe.CookingTime||"N/A")+" minutes",1)]),e("p",null,[t[9]||(t[9]=e("strong",null,"Difficulty:",-1)),v(" "+d(l.recipe.Difficulty||"N/A"),1)]),e("p",null,[t[10]||(t[10]=e("strong",null,"Servings:",-1)),v(" "+d(l.recipe.Servings||"N/A"),1)]),e("p",null,[t[11]||(t[11]=e("strong",null,"Recipe By:",-1)),v(" "+d(((h=(b=l.recipe.chef)==null?void 0:b.user)==null?void 0:h.name)||"Unknown"),1)])]),t[16]||(t[16]=e("br",null,null,-1)),e("div",null,[t[13]||(t[13]=e("p",{class:"font-bold"},"Description",-1)),e("p",H,d(l.recipe.Description),1)])]),l.recipe.VideoLink?(r(),n("div",U,[t[17]||(t[17]=e("p",{class:"text-small font-bold mb-4"},"Video Tutorial",-1)),e("div",P,[e("iframe",{src:u.getEmbedUrl(l.recipe.VideoLink),frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:"",class:"w-full h-[480px] rounded-lg"},null,8,F)])])):x("",!0),e("div",Y,[t[21]||(t[21]=e("h2",{class:"text-2xl font-bold"},"Reviews",-1)),l.user?(r(),n("div",q,[l.recipe.reviews.length===0?(r(),n("div",G," No reviews yet. ")):(r(),n("div",J,[(r(!0),n(w,null,g(l.recipe.reviews,(i,a)=>(r(),n("div",{key:a,class:"bg-white rounded-lg p-4 flex justify-between items-start shadow-sm"},[e("div",null,[e("p",K,[t[19]||(t[19]=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",class:"text-gray-500"},[e("circle",{cx:"12",cy:"8",r:"4",class:"fill-current text-gray-600"}),e("path",{d:"M12 14c-4 0-6 2-6 3v1h12v-1c0-1-2-3-6-3z",class:"fill-current text-gray-600"})],-1)),v(" "+d(i.user.name||"Anonymous"),1)]),e("p",Q,[e("i",null,d(i.Review),1)])]),e("div",W,[e("div",X,[(r(),n(w,null,g(5,c=>e("svg",{key:c,class:m({"fill-yellow-500":i.Star>=c,"fill-gray-300":i.Star<c,"cursor-pointer":!0,"hover:fill-yellow-400":!0,"transition-colors":!0}),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{d:i.Star>=c?"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z":"M12 15.4l3.76 2.28-1-4.17 3.27-2.84-4.28-.38L12 4.75l-1.75 5.68-4.28.38 3.27 2.84-1 4.17z"},null,8,Z)],2)),64))]),e("div",$,[i.user.id===l.user.id?(r(),n("button",{key:0,onClick:c=>u.startEditing(i),class:"bg-blue-400 text-white font-semibold py-1 px-3 rounded-lg hover:bg-blue-500 text-sm"}," Edit ",8,ee)):x("",!0),i.user.id===l.user.id?(r(),n("button",{key:1,onClick:c=>u.deleteReview(i.ReviewsID),class:"bg-red-400 text-white font-semibold py-1 px-3 rounded-lg hover:bg-red-500 text-sm"}," Delete ",8,te)):x("",!0)])])]))),128))]))])):(r(),n("div",O,t[18]||(t[18]=[e("p",{class:"text-white text-center text-lg font-bold"}," Log in to view or write a review. ",-1)]))),o.userHasReviewed?x("",!0):(r(),n("div",ie,[R(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=i=>o.reviewText=i),placeholder:"Review*",class:"w-full p-3 bg-gray-100 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-300 resize-none text-small"},null,512),[[k,o.reviewText]]),e("div",se,[t[20]||(t[20]=e("p",null,"Rate:",-1)),(r(),n(w,null,g(5,i=>e("svg",{key:i,onClick:a=>u.setRating(i),class:m({"fill-yellow-500":o.rating>=i,"fill-gray-300":o.rating<i,"cursor-pointer":!0,"hover:fill-yellow-400":!0,"transition-colors":!0}),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{d:o.rating>=i?"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z":"M12 15.4l3.76 2.28-1-4.17 3.27-2.84-4.28-.38L12 4.75l-1.75 5.68-4.28.38 3.27 2.84-1 4.17z"},null,8,re)],10,le)),64))]),e("div",ne,[e("button",{onClick:t[1]||(t[1]=(...i)=>u.submitReview&&u.submitReview(...i)),class:"bg-green-400 text-white font-semibold py-2 px-36 rounded-2xl hover:bg-green-500 text-small"}," Submit Review ")])]))]),o.editingReview?(r(),n("div",oe,[e("div",de,[t[23]||(t[23]=e("h3",{class:"text-lg font-bold mb-4"},"Edit Review",-1)),R(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=i=>o.editReviewText=i),class:"w-full p-3 bg-gray-100 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-300 resize-none text-small mb-4"},null,512),[[k,o.editReviewText]]),e("div",ue,[t[22]||(t[22]=e("p",null,"Rate:",-1)),(r(),n(w,null,g(5,i=>e("svg",{key:i,onClick:a=>o.editRating=i,class:m({"fill-yellow-500":o.editRating>=i,"fill-gray-300":o.editRating<i,"cursor-pointer":!0,"hover:fill-yellow-400":!0,"transition-colors":!0}),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{d:o.editRating>=i?"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z":"M12 15.4l3.76 2.28-1-4.17 3.27-2.84-4.28-.38L12 4.75l-1.75 5.68-4.28.38 3.27 2.84-1 4.17z"},null,8,ce)],10,ae)),64))]),e("div",ge,[e("button",{onClick:t[3]||(t[3]=(...i)=>u.cancelEdit&&u.cancelEdit(...i)),class:"bg-gray-400 text-white px-4 py-2 rounded"},"Cancel"),e("button",{onClick:t[4]||(t[4]=(...i)=>u.saveEdit&&u.saveEdit(...i)),class:"bg-green-400 text-white px-4 py-2 rounded"},"Save")])])])):x("",!0)]}),_:1})}const fe=D(I,[["render",we],["__scopeId","data-v-b3bfe26c"]]);export{fe as default};
